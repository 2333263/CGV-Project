<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: LeaderBoard.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: LeaderBoard.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Entry } from "./lbObject.js"
/**
 * @classdesc LeaderBoard class used to interact with php
 */
class leaderBoard {
    constructor() {
        this.document = document
        this.requested = false;
        this.LeaderBoard = []
        this.top10 = []
        this.curr10 = []
        this.cansend=false
        this.position = 0
        this.tempPos = 0
        this.startpos = 0
        /**
         * getNearest10 
         * @param {float} time score from player 
         * @returns {list} close
         */
        this.getNearest10 = function (time) {
            if (this.requested == false) {
                var http = new XMLHttpRequest()
                http.parent = this

                const url = httpUrls+"extractNearest10.php?Time=" + (time * 100)

                http.open("GET", url, true)
                http.send();
                http.onreadystatechange = function () {
                    this.parent.curr10 = [];
                    this.parent.startpos = 0
                    if (this.readyState == 4 &amp;&amp; this.status == 200) {
                        var temp = JSON.parse(http.responseText)

                        for (var i = 0; i &lt; temp.length; i++) {
                            this.parent.curr10.push(new Entry(temp[i].name, temp[i].time / 100))
                        }
                        this.parent.startpos = this.parent.getPos(1,this.parent.curr10[0].time);

                    }
                }
            }


            var close = []
            for (var i = 0; i &lt; this.curr10.length; i++) {
                var temp = (this.tempPos + i) + ")" + "  " + this.curr10[i].name + addSpaces(this.curr10[i].name, 10) + this.curr10[i].time;
                close.push(temp)

            }

            return (close)
        }
        /**
         * getAll 
         * @returns {list} all entries in the leaderboard
         */
        this.getAll = function () {
            if (this.requested == false) {
                var http = new XMLHttpRequest()
                http.parent = this
                const url = httpUrls+"extract.php"
                http.open("GET", url, true)
                http.send();
                http.onreadystatechange = function () {
                    this.parent.LeaderBoard = [];
                    if (this.readyState == 4 &amp;&amp; this.status == 200) {
                        var temp = JSON.parse(http.responseText)
                        for (var i = 0; i &lt; temp.length; i++) {
                            this.parent.LeaderBoard.push(new Entry(temp[i].name, temp[i].time / 100));
                        }
                    }
                }
                this.requested = true;
            }
            var all = []
            for (var i = 0; i &lt; this.LeaderBoard.length; i++) {
                var temp = (i + 1) + ")" + "  " + String(this.LeaderBoard[i].name) + addSpaces(this.LeaderBoard[i].name, 10) + this.LeaderBoard[i].time;
                all.push(temp)

            }

            return (all)
        }


        /**
         * @private
         * addItem
         * @param {class} parent leaderBoard.js 
         * @param {string} key name of player added to leaderboard
         * @param {float} value time (score) of player
         * @callback callback
         */
        this.addItem = function (parent,key, value,callback) {
            if (this.requested == false) {
                key=key.replaceAll("&amp;","")
                var http = new XMLHttpRequest()
                var url = httpUrls+"insert.php?NAME=" + key.replaceAll("`", "")+ "`TIME=" + value * 100
                http.open("GET", url, true)
                http.send();
                http.onreadystatechange = function () {
                    if (this.readyState == 4 &amp;&amp; this.status == 200) {
                        var temp = http.responseText
                        callback(parent)
                        if (temp == "[]") {
                            return;
                        }

                    }
                }
            }

            this.LeaderBoard.push(new Entry(key, value))
        }
        /**
         * @private
         * @param {string} word any string
         * @param {int} spaces number of spaces for display purposes
         * @return {string}
         * @function addSpaces
         */
        function addSpaces(word, spaces) {
            var temp = ""
            for (var i = word.length; i &lt; spaces; i++) {
                temp += " "
            }
            return (temp)

        }

        /**
         * getPos
         * @param {int} CB which class is calling
         * @param {float} time score of player
         * @returns {int}
         */
        this.getPos = function (CB, time) {
            if(CB==0){
                if (this.requested == false) {
                    var http = new XMLHttpRequest()
                    http.parent = this
                    const url = httpUrls+"extractpos.php?Time=" + time * 100
                    http.open("GET", url, true)
                    http.send();
                    http.onreadystatechange = function () {
                       
                        this.parent.position = 0;
                        if (this.readyState == 4 &amp;&amp; this.status == 200) {
                            var temp = JSON.parse(http.responseText)
                            this.parent.position = temp[0].POSITION;
                        }
                    }
                    this.requested = true;
                }

                return (this.position)
            }else{
                var http = new XMLHttpRequest()
                http.parent = this
                const url = httpUrls+"extractpos.php?Time=" + time * 100
                http.open("GET", url, true)
                http.send();
                http.onreadystatechange = function () {
                    this.parent.tempPos = 0;
                    if (this.readyState == 4 &amp;&amp; this.status == 200) {
                        var temp = JSON.parse(http.responseText)
                        this.parent.tempPos = temp[0].POSITION;
                    }
                }
                return (this.tempPos)
            }

            
        }

    }
}
export { leaderBoard }






</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BuildWorld.html">BuildWorld</a></li><li><a href="Entry.html">Entry</a></li><li><a href="leaderBoard.html">leaderBoard</a></li><li><a href="LoadingScreen.html">LoadingScreen</a></li><li><a href="MainMenu.html">MainMenu</a></li><li><a href="musicHandler.html">musicHandler</a></li><li><a href="POSTPROCESSINGPASSES.html">POSTPROCESSINGPASSES</a></li><li><a href="SPARK.html">SPARK</a></li><li><a href="Targets.html">Targets</a></li><li><a href="threeToCannonObj.html">threeToCannonObj</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addTargets">addTargets</a></li><li><a href="global.html#afterLoad">afterLoad</a></li><li><a href="global.html#checkState">checkState</a></li><li><a href="global.html#doneLoading">doneLoading</a></li><li><a href="global.html#drawSkyBox">drawSkyBox</a></li><li><a href="global.html#enableMoving">enableMoving</a></li><li><a href="global.html#filePath">filePath</a></li><li><a href="global.html#gunshotSound">gunshotSound</a></li><li><a href="global.html#handleDoor">handleDoor</a></li><li><a href="global.html#handleSparks">handleSparks</a></li><li><a href="global.html#handleTrails">handleTrails</a></li><li><a href="global.html#hitTarget">hitTarget</a></li><li><a href="global.html#httpUrls">httpUrls</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#Level1">Level1</a></li><li><a href="global.html#Level2">Level2</a></li><li><a href="global.html#Level3">Level3</a></li><li><a href="global.html#mapTargets">mapTargets</a></li><li><a href="global.html#move">move</a></li><li><a href="global.html#MoveTargets">MoveTargets</a></li><li><a href="global.html#rainSound">rainSound</a></li><li><a href="global.html#removeTargets">removeTargets</a></li><li><a href="global.html#renderWorld">renderWorld</a></li><li><a href="global.html#setStartTime">setStartTime</a></li><li><a href="global.html#stormSky">stormSky</a></li><li><a href="global.html#thunderSound">thunderSound</a></li><li><a href="global.html#worldTargets">worldTargets</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Thu Jun 09 2022 11:04:21 GMT+0200 (South Africa Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
